(()=>{"use strict";const e=(()=>{const e=document.getElementById("board");let t=[];const i=()=>{for(let i=0;i<8;i++)for(let a=0;a<8;a++){const n=document.createElement("div");n.classList.add("tile"),(i+a)%2==1&&n.classList.add("tile-black"),n.id="tile-id-"+(8*i+a),e.appendChild(n),t.push(n)}},a=e=>{t[e].replaceChildren()};return i(),{resetBoard:()=>{e.replaceChildren(),t=[],i()},addPiece:(e,i)=>{a(e.getPosition()),t[i].appendChild(e.getPiece())},removePiece:a,getTiles:()=>t}})(),t=(e,t)=>{const i=e,a="white"===e?1:-1,n=document.createElement("div");n.classList.add("piece-"+e),n.setAttribute("draggable","true");let s=t;const o=(e,t,n)=>{let o,l=t[n];return 0===n?[1,9,17,25,33,41,49,55].includes(s)||(l+=7*a,"black"===i&&(l-=2)):1===n&&([6,14,22,30,38,46,54,62].includes(s)||(l+=9*a,"black"===i&&(l+=2))),o=document.getElementById("tile-id-"+l),void 0!==o.children[0]?e.push(t[n]):e.push(l),e};return{getPiece:()=>n,getPosition:()=>s,setPosition:e=>{s=parseInt(e)},getAvailablePos:e=>{let t=[],n=null,l=null;return s%8!=0&&(n=s+7*a,"black"===i&&(n-=2)),[7,15,23,31,39,47,55,63].includes(s)||(l=s+9*a,"black"===i&&(l+=2)),t.push(n),t.push(l),t=((e,t)=>{let a=[];for(let n=0;n<e.length;n++)if(null!==e[n]){const s=t[e[n]].id,l=document.getElementById(s),r="white"===i?"black":"white";void 0!==l.children[0]&&l.children[0].classList.contains("piece-"+r)?a=o(a,e,n):a.push(e[n])}return a})(t,e),t},getColor:()=>i,getShift:()=>a}};function i(e,t,i,a){if("up"===a){const a=t+14*e.getShift()-4,n=t+14*e.getShift();return i===a||i===n}if("down"===a){const a=t+14*e.getShift(),n=t+(14*e.getShift()+4);return i===a||i===n}}function a(t,a){const n=t.getPosition();if(a>n&&i(t,a,n,"up")){const t=a-(a-n)/2;e.removePiece(t)}if(a<n&&i(t,a,n,"down")){const t=a-(a-n)/2;e.removePiece(t)}}function n(t){const i=t.dataTransfer.getData("text/plain"),n=t.target.id,s=i<0?"black":"white";if(function(t,i,a){let n=[];i<0?n=r[Math.abs(i)-1].getAvailablePos(e.getTiles()):i>0&&(n=l[Math.abs(i)-1].getAvailablePos(e.getTiles()));let s=!1;return n.forEach((e=>{a==="tile-id-"+e&&(s=!0)})),s}(0,i,n)){let o;if(void 0===t.target.children[0]){const t=n.split("-");"black"===s?(e.addPiece(r[Math.abs(i)-1],t[2]),o=r[Math.abs(i)-1].getPosition(),r[Math.abs(i)-1].setPosition(t[2]),a(r[Math.abs(i)-1],o)):"white"===s&&(e.addPiece(l[Math.abs(i)-1],t[2]),o=l[Math.abs(i)-1].getPosition(),l[Math.abs(i)-1].setPosition(t[2]),a(l[Math.abs(i)-1],o))}}}function s(e,t){let i=1,a=2;"Two"===t&&(i=62,a=-a);for(let t=0;t<3;t++){for(let n=0;n<4;n++)e[4*t+n].setPosition(i),i+=a;0===t&&(i-=a/2),1===t&&(i+=a/2)}}function o(e,i){for(let a=0;a<12;a++){const n=t(i,a);e.push(n)}}let l=[],r=[];o(l,"white"),s(l,"One"),o(r,"black"),s(r,"Two"),l.forEach((t=>{e.addPiece(t,t.getPosition())})),r.forEach((t=>{e.addPiece(t,t.getPosition())})),l.forEach(((e,t)=>{e.getPiece().addEventListener("dragstart",(e=>{e.dataTransfer.setData("text/plain",t+1)}))})),r.forEach(((e,t)=>{e.getPiece().addEventListener("dragstart",(e=>{e.dataTransfer.setData("text/plain",-t-1)}))})),e.getTiles().forEach((e=>{e.addEventListener("dragenter",(()=>{})),e.addEventListener("dragover",(e=>{e.preventDefault()})),e.addEventListener("dragleave",(e=>{e.preventDefault()})),e.addEventListener("drop",n)}))})();